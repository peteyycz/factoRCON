<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script>
window.addEventListener("load", function() {
        var output = document.getElementById("output")
        var input = document.getElementById("input")
        var ws = new WebSocket("{{.}}")
        var print = function(message) {
                var d = document.createElement("div")
                d.innerHTML = message
                output.appendChild(d)
        }
        ws.onopen = function(event) {
                print("OPEN")
        }
        ws.onclose = function(event) {
                print("CLOSE")
                ws = null
        }
        ws.onmessage = function(event) {
                print("RESPONSE: " + event.data)
        }
        ws.onerror = function(event) {
                print("ERROR: " + event.data)
        }

        document.getElementById("send").onclick = function(event) {
                if (!ws) {
                        return false
                }
                print("SEND: " + input.value)
                ws.send(input.value)
                return false
        }
})
</script>
</head>
<body>
        <div id="output"></div>
        <form>
                <input id="input" type="text" value="Hello world!">
                <button id="send">Send</button>
        </form>
</body>
</html>
